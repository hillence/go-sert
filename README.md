# go-sert

Telegram-бот для продажи сертификатов. Теперь приложение запускает HTTP-сервер на Gin, поэтому его можно разворачивать на Timeweb Apps (тип приложения «Go + Gin»), сохраняя опрос Telegram по Long Polling.

## Переменные окружения

Настройте значения перед запуском локально или в Timeweb Apps:

| Переменная | Описание |
|------------|----------|
| `BOT_TOKEN` | Токен Telegram-бота |
| `ADMIN_ID` | Telegram ID администратора, который получает уведомления об оплате |
| `CARD_NUMBER` | Номер карты, на которую отправляется оплата |
| `CARD_BANK` | Название банка (опционально, дефолт `Bank`) |
| `CARD_NAME` | Имя получателя на карте (опционально, дефолт `Card Holder`) |
| `PORT` | Порт HTTP-сервера (Timeweb Apps автоматически задаёт переменную, локально можно использовать `8080`) |

## Локальный запуск

```bash
export BOT_TOKEN=xxx
export ADMIN_ID=123456789
export CARD_NUMBER=xxxx
export CARD_BANK="My Bank"
export CARD_NAME="Имя Фамилия"
go run .
```

HTTP-сервер будет доступен на `http://localhost:${PORT}` и отдаёт health-check по `/healthz`.

## Деплой на Timeweb Apps (Go + Gin)

1. **Git-репозиторий.** Запушьте код в собственный репозиторий (GitHub/GitLab/Bitbucket).
2. **Создайте приложение.** В панели Timeweb Apps выберите «Создать → Приложение → Go + Gin» и подключите репозиторий.
3. **Команды сборки/старта.**
   - Build command: `go build -o app .`
   - Start command: `./app`
4. **Переменные окружения.** В разделе «Настройки → Переменные» добавьте значения из списка выше. Timeweb автоматически подставляет системную переменную `PORT`, оставьте её нетронутой.
5. **Данные.** Файл `data/products.json` включён в репозиторий. Обновите его под свои товары перед деплоем.
6. **Развёртывание.** Сохраните настройки и запустите деплой. После развёртывания откройте лог приложения и убедитесь, что бот успешно подключился к Telegram, а HTTP-сервер слушает `0.0.0.0:<PORT>`.

> Примечание: Бот продолжает использовать Long Polling и не требует настройки вебхуков. Главное, чтобы инстанс был запущен постоянно.

